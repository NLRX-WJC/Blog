<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1. å‰è¨€ | éš¾å‡‰çƒ­è¡€</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/Blog/logo.png">
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/Blog/assets/css/0.styles.c39b1c7d.css" as="style"><link rel="preload" href="/Blog/assets/js/app.b4826e9a.js" as="script"><link rel="preload" href="/Blog/assets/js/2.f12389d1.js" as="script"><link rel="preload" href="/Blog/assets/js/1.9a8c901b.js" as="script"><link rel="preload" href="/Blog/assets/js/23.10dcfcdc.js" as="script"><link rel="preload" href="/Blog/assets/js/42.d35d384d.js" as="script"><link rel="prefetch" href="/Blog/assets/js/10.743b0d14.js"><link rel="prefetch" href="/Blog/assets/js/100.0fe1f129.js"><link rel="prefetch" href="/Blog/assets/js/101.e87fac42.js"><link rel="prefetch" href="/Blog/assets/js/102.e4e4bf7e.js"><link rel="prefetch" href="/Blog/assets/js/103.8b8611c5.js"><link rel="prefetch" href="/Blog/assets/js/104.c7173d23.js"><link rel="prefetch" href="/Blog/assets/js/105.a1edfc76.js"><link rel="prefetch" href="/Blog/assets/js/106.39ef7567.js"><link rel="prefetch" href="/Blog/assets/js/107.42c3d6f1.js"><link rel="prefetch" href="/Blog/assets/js/108.20ad246e.js"><link rel="prefetch" href="/Blog/assets/js/109.e459c131.js"><link rel="prefetch" href="/Blog/assets/js/11.af93de8a.js"><link rel="prefetch" href="/Blog/assets/js/110.54e766aa.js"><link rel="prefetch" href="/Blog/assets/js/111.421d99b6.js"><link rel="prefetch" href="/Blog/assets/js/112.712d329e.js"><link rel="prefetch" href="/Blog/assets/js/113.e4b397be.js"><link rel="prefetch" href="/Blog/assets/js/114.4ea1e527.js"><link rel="prefetch" href="/Blog/assets/js/115.5bdf5712.js"><link rel="prefetch" href="/Blog/assets/js/116.7cc546cf.js"><link rel="prefetch" href="/Blog/assets/js/117.930c1da2.js"><link rel="prefetch" href="/Blog/assets/js/118.882dd02b.js"><link rel="prefetch" href="/Blog/assets/js/119.0d157f08.js"><link rel="prefetch" href="/Blog/assets/js/12.ad276a99.js"><link rel="prefetch" href="/Blog/assets/js/120.fb4ca4cf.js"><link rel="prefetch" href="/Blog/assets/js/121.4850cc3b.js"><link rel="prefetch" href="/Blog/assets/js/122.22e45189.js"><link rel="prefetch" href="/Blog/assets/js/123.4d89a432.js"><link rel="prefetch" href="/Blog/assets/js/124.267b1a2a.js"><link rel="prefetch" href="/Blog/assets/js/125.e0b7dd72.js"><link rel="prefetch" href="/Blog/assets/js/126.0ecb1c6d.js"><link rel="prefetch" href="/Blog/assets/js/127.b8533a73.js"><link rel="prefetch" href="/Blog/assets/js/128.193f25f3.js"><link rel="prefetch" href="/Blog/assets/js/129.e04d72b3.js"><link rel="prefetch" href="/Blog/assets/js/13.f70fef15.js"><link rel="prefetch" href="/Blog/assets/js/130.857749d9.js"><link rel="prefetch" href="/Blog/assets/js/131.9e7e8e2d.js"><link rel="prefetch" href="/Blog/assets/js/132.b659f7ee.js"><link rel="prefetch" href="/Blog/assets/js/133.f541bfd1.js"><link rel="prefetch" href="/Blog/assets/js/134.d846303c.js"><link rel="prefetch" href="/Blog/assets/js/135.4ae82a87.js"><link rel="prefetch" href="/Blog/assets/js/136.ab440a52.js"><link rel="prefetch" href="/Blog/assets/js/137.5c1ce3de.js"><link rel="prefetch" href="/Blog/assets/js/138.bc380cb0.js"><link rel="prefetch" href="/Blog/assets/js/139.87dd9ae2.js"><link rel="prefetch" href="/Blog/assets/js/14.4b9ff04b.js"><link rel="prefetch" href="/Blog/assets/js/140.1ec02b83.js"><link rel="prefetch" href="/Blog/assets/js/141.602544cc.js"><link rel="prefetch" href="/Blog/assets/js/142.ddcbb0e7.js"><link rel="prefetch" href="/Blog/assets/js/143.ccb24496.js"><link rel="prefetch" href="/Blog/assets/js/144.7d073b6c.js"><link rel="prefetch" href="/Blog/assets/js/145.0884a72c.js"><link rel="prefetch" href="/Blog/assets/js/146.6718a9a7.js"><link rel="prefetch" href="/Blog/assets/js/147.d65332a2.js"><link rel="prefetch" href="/Blog/assets/js/148.987288f1.js"><link rel="prefetch" href="/Blog/assets/js/149.9213f640.js"><link rel="prefetch" href="/Blog/assets/js/15.945579bc.js"><link rel="prefetch" href="/Blog/assets/js/150.9a9594aa.js"><link rel="prefetch" href="/Blog/assets/js/151.d71f84de.js"><link rel="prefetch" href="/Blog/assets/js/152.4b0eddb0.js"><link rel="prefetch" href="/Blog/assets/js/153.b520229a.js"><link rel="prefetch" href="/Blog/assets/js/154.0641c9ae.js"><link rel="prefetch" href="/Blog/assets/js/155.4a61bd88.js"><link rel="prefetch" href="/Blog/assets/js/16.2b896f4e.js"><link rel="prefetch" href="/Blog/assets/js/17.d9a02527.js"><link rel="prefetch" href="/Blog/assets/js/18.0a38bc44.js"><link rel="prefetch" href="/Blog/assets/js/19.f64639f8.js"><link rel="prefetch" href="/Blog/assets/js/20.dad5839d.js"><link rel="prefetch" href="/Blog/assets/js/21.cebcff6f.js"><link rel="prefetch" href="/Blog/assets/js/22.d61443c3.js"><link rel="prefetch" href="/Blog/assets/js/24.eac55217.js"><link rel="prefetch" href="/Blog/assets/js/25.caa252cc.js"><link rel="prefetch" href="/Blog/assets/js/26.f6827dd4.js"><link rel="prefetch" href="/Blog/assets/js/27.4868930e.js"><link rel="prefetch" href="/Blog/assets/js/28.a80ef469.js"><link rel="prefetch" href="/Blog/assets/js/29.62a2b451.js"><link rel="prefetch" href="/Blog/assets/js/3.e1c52e30.js"><link rel="prefetch" href="/Blog/assets/js/30.a834189a.js"><link rel="prefetch" href="/Blog/assets/js/31.3571c2a9.js"><link rel="prefetch" href="/Blog/assets/js/32.c63c6fc8.js"><link rel="prefetch" href="/Blog/assets/js/33.a41c30ac.js"><link rel="prefetch" href="/Blog/assets/js/34.b33a8ef7.js"><link rel="prefetch" href="/Blog/assets/js/35.d47159c4.js"><link rel="prefetch" href="/Blog/assets/js/36.32e7da66.js"><link rel="prefetch" href="/Blog/assets/js/37.6debf01c.js"><link rel="prefetch" href="/Blog/assets/js/38.bf172d4a.js"><link rel="prefetch" href="/Blog/assets/js/39.fd6fa964.js"><link rel="prefetch" href="/Blog/assets/js/4.8d100e46.js"><link rel="prefetch" href="/Blog/assets/js/40.5cb55fe1.js"><link rel="prefetch" href="/Blog/assets/js/41.6e94a86a.js"><link rel="prefetch" href="/Blog/assets/js/43.2ff21390.js"><link rel="prefetch" href="/Blog/assets/js/44.f77b0561.js"><link rel="prefetch" href="/Blog/assets/js/45.bf168446.js"><link rel="prefetch" href="/Blog/assets/js/46.2c8f19d9.js"><link rel="prefetch" href="/Blog/assets/js/47.829f134c.js"><link rel="prefetch" href="/Blog/assets/js/48.99b7849f.js"><link rel="prefetch" href="/Blog/assets/js/49.a770e8fc.js"><link rel="prefetch" href="/Blog/assets/js/5.611a8ad6.js"><link rel="prefetch" href="/Blog/assets/js/50.d8e3ab66.js"><link rel="prefetch" href="/Blog/assets/js/51.66542113.js"><link rel="prefetch" href="/Blog/assets/js/52.e087e280.js"><link rel="prefetch" href="/Blog/assets/js/53.00ad1378.js"><link rel="prefetch" href="/Blog/assets/js/54.71c39b5a.js"><link rel="prefetch" href="/Blog/assets/js/55.b4608f10.js"><link rel="prefetch" href="/Blog/assets/js/56.49dfb259.js"><link rel="prefetch" href="/Blog/assets/js/57.b3be5c58.js"><link rel="prefetch" href="/Blog/assets/js/58.0ffca1a5.js"><link rel="prefetch" href="/Blog/assets/js/59.56156659.js"><link rel="prefetch" href="/Blog/assets/js/6.187dbfd5.js"><link rel="prefetch" href="/Blog/assets/js/60.497645bb.js"><link rel="prefetch" href="/Blog/assets/js/61.306c2c10.js"><link rel="prefetch" href="/Blog/assets/js/62.9b88a36f.js"><link rel="prefetch" href="/Blog/assets/js/63.1264690b.js"><link rel="prefetch" href="/Blog/assets/js/64.7fe03e27.js"><link rel="prefetch" href="/Blog/assets/js/65.7210c6ce.js"><link rel="prefetch" href="/Blog/assets/js/66.7f9dec28.js"><link rel="prefetch" href="/Blog/assets/js/67.cd82d776.js"><link rel="prefetch" href="/Blog/assets/js/68.5f3cdd86.js"><link rel="prefetch" href="/Blog/assets/js/69.a16b6171.js"><link rel="prefetch" href="/Blog/assets/js/7.f7fa1be8.js"><link rel="prefetch" href="/Blog/assets/js/70.62c6b6ea.js"><link rel="prefetch" href="/Blog/assets/js/71.3972ba26.js"><link rel="prefetch" href="/Blog/assets/js/72.e156aa56.js"><link rel="prefetch" href="/Blog/assets/js/73.916bca04.js"><link rel="prefetch" href="/Blog/assets/js/74.2a887417.js"><link rel="prefetch" href="/Blog/assets/js/75.06ffc7f7.js"><link rel="prefetch" href="/Blog/assets/js/76.35724f8a.js"><link rel="prefetch" href="/Blog/assets/js/77.02781a9b.js"><link rel="prefetch" href="/Blog/assets/js/78.ece65f72.js"><link rel="prefetch" href="/Blog/assets/js/79.aaf75ccc.js"><link rel="prefetch" href="/Blog/assets/js/80.34ee80ab.js"><link rel="prefetch" href="/Blog/assets/js/81.95b6f9d7.js"><link rel="prefetch" href="/Blog/assets/js/82.067284ca.js"><link rel="prefetch" href="/Blog/assets/js/83.cad8c68a.js"><link rel="prefetch" href="/Blog/assets/js/84.a2ffedbe.js"><link rel="prefetch" href="/Blog/assets/js/85.bd41f969.js"><link rel="prefetch" href="/Blog/assets/js/86.2cbdd8ae.js"><link rel="prefetch" href="/Blog/assets/js/87.6f30dca9.js"><link rel="prefetch" href="/Blog/assets/js/88.06fd639a.js"><link rel="prefetch" href="/Blog/assets/js/89.e861c9b5.js"><link rel="prefetch" href="/Blog/assets/js/90.0e42b6dd.js"><link rel="prefetch" href="/Blog/assets/js/91.a4eaee35.js"><link rel="prefetch" href="/Blog/assets/js/92.69dde2ed.js"><link rel="prefetch" href="/Blog/assets/js/93.6691c827.js"><link rel="prefetch" href="/Blog/assets/js/94.99bc6e60.js"><link rel="prefetch" href="/Blog/assets/js/95.f809db67.js"><link rel="prefetch" href="/Blog/assets/js/96.7ec4e1ed.js"><link rel="prefetch" href="/Blog/assets/js/97.254696a8.js"><link rel="prefetch" href="/Blog/assets/js/98.fad8583b.js"><link rel="prefetch" href="/Blog/assets/js/99.bac30b28.js"><link rel="prefetch" href="/Blog/assets/js/vendors~docsearch.3647cbca.js">
    <link rel="stylesheet" href="/Blog/assets/css/0.styles.c39b1c7d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog/" class="home-link router-link-active"><img src="/Blog/logo.png" alt="éš¾å‡‰çƒ­è¡€" class="logo"> <span class="site-name can-hide">éš¾å‡‰çƒ­è¡€</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://nlrx-wjc.github.io/Learn-Vue-Source-Code/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  é€è¡Œå‰–æVue.jsæºç 
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/NLRX-WJC/Blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://nlrx-wjc.github.io/Learn-Vue-Source-Code/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  é€è¡Œå‰–æVue.jsæºç 
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/NLRX-WJC/Blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/Blog/about/" class="sidebar-link">å…³äºä½œè€…</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>æ·±å…¥ç†è§£React</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Blog/react/hook/ä¸ºä»€ä¹ˆéœ€è¦Hooks" class="sidebar-heading clickable open"><span>æ·±å…¥ç†è§£React Hooks</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/react/hook/ä¸ºä»€ä¹ˆéœ€è¦Hooks.html" class="sidebar-link">ä¸ºä»€ä¹ˆéœ€è¦Hooks</a></li><li><a href="/Blog/react/hook/Hookså·¥ä½œæœºåˆ¶.html" class="active sidebar-link">Hookså·¥ä½œæœºåˆ¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/react/hook/Hookså·¥ä½œæœºåˆ¶.html#_1-å‰è¨€" class="sidebar-link">1. å‰è¨€</a></li><li class="sidebar-sub-header"><a href="/Blog/react/hook/Hookså·¥ä½œæœºåˆ¶.html#_2-ä¸æŒ‰è§„å®šæ¥ä¼šæ€æ ·" class="sidebar-link">2. ä¸æŒ‰è§„å®šæ¥ä¼šæ€æ ·</a></li><li class="sidebar-sub-header"><a href="/Blog/react/hook/Hookså·¥ä½œæœºåˆ¶.html#_3-é€è¿‡ç°è±¡çœ‹æœ¬è´¨" class="sidebar-link">3. é€è¿‡ç°è±¡çœ‹æœ¬è´¨</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/react/hook/Hookså·¥ä½œæœºåˆ¶.html#_3-1-é¦–æ¬¡æ¸²æŸ“" class="sidebar-link">3.1 é¦–æ¬¡æ¸²æŸ“</a></li><li class="sidebar-sub-header"><a href="/Blog/react/hook/Hookså·¥ä½œæœºåˆ¶.html#_3-2-æ›´æ–°æ¸²æŸ“" class="sidebar-link">3.2 æ›´æ–°æ¸²æŸ“</a></li><li class="sidebar-sub-header"><a href="/Blog/react/hook/Hookså·¥ä½œæœºåˆ¶.html#_3-3-å°ç»“" class="sidebar-link">3.3 å°ç»“</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog/react/hook/Hookså·¥ä½œæœºåˆ¶.html#_4-å›çœ‹demo" class="sidebar-link">4. å›çœ‹Demo</a></li><li class="sidebar-sub-header"><a href="/Blog/react/hook/Hookså·¥ä½œæœºåˆ¶.html#_5-æ€»ç»“" class="sidebar-link">5. æ€»ç»“</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Blog/react/lifecycle/æ—§ç‰ˆ" class="sidebar-heading clickable"><span>æ·±å…¥ç†è§£Reactç”Ÿå‘½å‘¨æœŸ</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/Blog/react/ç†è§£Reactä¸­çš„äº‹åŠ¡æœºåˆ¶.html" class="sidebar-link">ç†è§£Reactä¸­çš„äº‹åŠ¡æœºåˆ¶</a></li><li><a href="/Blog/react/setStateåˆ°åº•æ˜¯åŒæ­¥çš„ï¼Œè¿˜æ˜¯å¼‚æ­¥çš„.html" class="sidebar-link">setStateåˆ°åº•æ˜¯åŒæ­¥çš„ï¼Œè¿˜æ˜¯å¼‚æ­¥çš„</a></li><li><a href="/Blog/react/å¦‚ä½•ä¼˜é›…çš„å®ç°ç»„ä»¶é€»è¾‘å¤ç”¨.html" class="sidebar-link">å¦‚ä½•ä¼˜é›…çš„å®ç°ç»„ä»¶é€»è¾‘å¤ç”¨</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Promise</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ•™å…„å¼Ÿå¥³æœ‹å‹å­¦Koa2</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ•°æ®ç»“æ„</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å‰‘æŒ‡offer-JavaScripté¢˜è§£</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ä½¿ç”¨TypeScripté‡æ„axios</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>é€è¡Œå‰–æVue.jsæºç </span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-å‰è¨€"><a href="#_1-å‰è¨€" class="header-anchor">#</a> 1. å‰è¨€</h2> <p>å¦‚æœä½ åœ¨ä¹‹å‰å¼€å‘ä¸­ä½¿ç”¨è¿‡ <code>React Hooks</code> ï¼Œé‚£ä¹ˆä½ ä¸€å®šçŸ¥é“ä½¿ç”¨ <code>React Hooks</code> æœ‰ä¸¤æ¡é“çš„ä½¿ç”¨è§„åˆ™ï¼š</p> <ul><li>åªåœ¨ <code>React</code> å‡½æ•°ä¸­è°ƒç”¨ <code>Hook</code>ï¼›</li> <li>ä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ <code>Hook</code>ï¼›</li></ul> <p>å…¶ä¸­ç¬¬ä¸€æ¡è§„åˆ™ã€Œåªåœ¨ <code>React</code> å‡½æ•°ä¸­è°ƒç”¨ <code>Hook</code> ã€å¾ˆå¥½ç†è§£ï¼Œ <code>React Hooks</code> æœ¬æ¥å°±æ˜¯ä¸ºå‡½æ•°ç»„ä»¶è€Œç”Ÿçš„ï¼Œåœ¨æ™®é€šå‡½æ•°ä¸­è°ƒç”¨æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚ä½†æ˜¯ç¬¬äºŒæ¡ã€Œä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ <code>Hook</code> ã€çš„è§„åˆ™å°±å¾ˆå€¼å¾—ç©å‘³äº†ï¼Œä½ ä¸ç¦ä¼šç–‘é—®ï¼šä¸ºå•¥ä¸è®©æˆ‘åœ¨å¾ªç¯ã€æ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ <code>Hook</code> ï¼Ÿä½ ä¸€ä¸ª <code>API</code> æä¾›è€…å¯ä»¥é™åˆ¶æˆ‘æ€ä¹ˆç”¨ä½ çš„ <code>API</code> ï¼Œä½ è¿™æ€ä¹ˆè¿˜é™åˆ¶æˆ‘åœ¨å“ªç”¨ï¼Ÿ</p> <p>å…³äºè¿™æ¡è§„åˆ™ï¼Œ <code>React</code> å®˜æ–¹æ˜¯è¿™ä¹ˆè¡¥å……è§£é‡Šçš„ï¼š<strong>ä½ å¿…é¡»ç¡®ä¿ <code>Hook</code> åœ¨æ¯æ¬¡æ¸²æŸ“ä¸­éƒ½æŒ‰ç…§åŒæ ·çš„é¡ºåºè¢«è°ƒç”¨ã€‚è¿™æ ·æ‰èƒ½è®© <code>React</code> åœ¨å¤šæ¬¡çš„ <code>hook</code> è°ƒç”¨ä¹‹é—´ä¿æŒ <code>hook</code> çŠ¶æ€çš„æ­£ç¡®ã€‚</strong></p> <p>é‡ç‚¹åœ¨è¿™é‡Œï¼šç¡®ä¿æ¯ä¸€æ¬¡æ¸²æŸ“ä¸­éƒ½æŒ‰ç…§åŒæ ·çš„é¡ºåºè¢«è°ƒç”¨ã€‚<strong>é¡ºåºï¼é¡ºåºï¼ï¼é¡ºåºï¼ï¼ï¼</strong></p> <p>æƒ³æƒ³çœ‹ï¼Œå¦‚æœä½ åœ¨æ¡ä»¶è¯­å¥ä¸­è°ƒç”¨äº†æŸä¸ª <code>Hook</code> ï¼Œé‚£ä¹ˆè¿™ä¸ª <code>Hook</code> å¿…ç„¶ä¸æ˜¯æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šè¢«è°ƒç”¨ï¼Œåªæœ‰æ¡ä»¶ä¸ºçœŸäº†æ‰ä¼šè¢«è°ƒç”¨ï¼Œè¿™å°±å¯¼è‡´åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶ï¼Œæœ‰æ—¶æœ‰5ä¸ª <code>Hook</code> è¢«è°ƒç”¨ï¼Œæœ‰æ—¶å´åªæœ‰3ä¸ªè¢«è°ƒç”¨ï¼Œ <code>Hook</code> çš„è°ƒç”¨é¡ºåºå˜å¾—ä¸ç¡®å®šäº†ã€‚é‚£ä¸ºä»€ä¹ˆ <code>Hook</code> çš„è°ƒç”¨é¡ºåºè¿™ä¹ˆé‡è¦å‘¢ï¼Ÿä¸ºä»€ä¹ˆä¸€å®šè¦ä¿è¯æ‰€æœ‰çš„ <code>Hook</code> åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½è¦ä»¥åŒæ ·çš„é¡ºåºè¢«è°ƒç”¨å‘¢ï¼Ÿè¿™å°±æ¶‰åŠåˆ° <code>Hook</code> çš„å®ç°æœºåˆ¶äº†ï¼Œæ¥ä¸‹æ¥ï¼Œæœ¬æ–‡å°±ä»æºç è§’åº¦å‡ºå‘ï¼Œæ¥æ¢ç©¶ä¸€ä¸‹ <code>React</code> ä¸ºä»€ä¹ˆè¦é™åˆ¶ <code>Hook</code> çš„è°ƒç”¨é¡ºåºã€‚</p> <h2 id="_2-ä¸æŒ‰è§„å®šæ¥ä¼šæ€æ ·"><a href="#_2-ä¸æŒ‰è§„å®šæ¥ä¼šæ€æ ·" class="header-anchor">#</a> 2. ä¸æŒ‰è§„å®šæ¥ä¼šæ€æ ·</h2> <p>åœ¨ç ”ç©¶æºç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å‡å¦‚ä¸ä¿è¯ <code>Hooks</code> çš„æ‰§è¡Œé¡ºåºï¼Œä¼šå‡ºç°ä»€ä¹ˆæ ·çš„ç°è±¡ï¼Ÿ</p> <p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª <a href="https://codesandbox.io/s/relaxed-cookies-p0edv?file=/src/PersonalInfoComponent.jsx" target="_blank" rel="noopener noreferrer">Demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œå¦‚ä¸‹ï¼š</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">PersonalInfoComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span>setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;éš¾å‡‰çƒ­è¡€&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>career<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;å‰ç«¯å¼€å‘&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>personalInfo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">å§“åï¼š</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">å¹´é¾„ï¼š</span><span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">èŒä¸šï¼š</span><span class="token punctuation">{</span>career<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;çƒ­è¡€éš¾å‡‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">&gt;</span></span><span class="token plain-text">
        ä¿®æ”¹å§“å
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> PersonalInfoComponent<span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>åœ¨è¿™ä¸ª <code>Demo</code> ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>useState</code> å®šä¹‰äº†ä¸‰ä¸ªçŠ¶æ€ï¼Œåˆ†åˆ«æ˜¯ï¼šå§“åã€å¹´é¾„å’ŒèŒä¸šã€‚å¹¶åœ¨è§†å›¾ä¸­å°†è¿™ä¸‰ä¸ªçŠ¶æ€å±•ç¤ºå‡ºæ¥ï¼Œç‚¹å‡»ã€Œä¿®æ”¹å§“åã€æŒ‰é’®å¯ä¿®æ”¹å§“åï¼Œå¦‚ä¸‹ï¼š</p> <p><img src="/Blog/assets/img/1.614221e8.png" alt=""></p> <p>okï¼Œæ²¡æœ‰é—®é¢˜ï¼Œç‚¹å‡»ã€Œä¿®æ”¹å§“åã€æŒ‰é’®ä¹Ÿèƒ½æ­£å¸¸ä¿®æ”¹å§“åï¼Œä»¥ä¸Šéƒ½æ˜¯åœ¨æ­£å¸¸ä½¿ç”¨ <code>Hooks</code> ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åšä¸€ç‚¹è°ƒæ•´ï¼Œä½¿å¾— <code>Hooks</code> çš„è°ƒç”¨é¡ºåºä¸å†ä¿æŒä¸€è‡´ï¼Œä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> isMounted <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">PersonalInfoComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> career<span class="token punctuation">,</span> setName<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;isMounted&quot;</span><span class="token punctuation">,</span> isMounted<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isMounted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// eslint-disable-next-line</span>
    <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;éš¾å‡‰çƒ­è¡€&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// eslint-disable-next-line</span>
    <span class="token punctuation">[</span>age<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// if å†…éƒ¨çš„é€»è¾‘æ‰§è¡Œä¸€æ¬¡åï¼Œå°±å°† isMounted ç½®ä¸º trueï¼ˆè¯´æ˜å·²æŒ‚è½½ï¼Œåç»­éƒ½ä¸å†æ˜¯é¦–æ¬¡æ¸²æŸ“äº†ï¼‰</span>
    isMounted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">[</span>career<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;å‰ç«¯å¼€å‘&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;career&quot;</span><span class="token punctuation">,</span> career<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>personalInfo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">å§“åï¼š</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">å¹´é¾„ï¼š</span><span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">èŒä¸šï¼š</span><span class="token punctuation">{</span>career<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;çƒ­è¡€éš¾å‡‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">&gt;</span></span><span class="token plain-text">
        ä¿®æ”¹å§“å
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> PersonalInfoComponent<span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>ä»ä¸Šé¢ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æŠŠä¸€éƒ¨åˆ†çš„ <code>useState</code> æ“ä½œæ”¾è¿› <code>if</code> æ¡ä»¶è¯­å¥é‡Œï¼Œåªæœ‰åœ¨ç»„ä»¶é¦–æ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼Œåå­—å’Œå¹´é¾„çš„ <code>useState</code> æ‰ä¼šè¢«è°ƒç”¨ï¼Œåœ¨ä¹‹åçš„æ›´æ–°æ¸²æŸ“ä¸­å°±åªæœ‰èŒä¸šçš„ <code>useState</code> è¢«è°ƒç”¨ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†ç‚¹å‡»ã€Œä¿®æ”¹å§“åã€æŒ‰é’®ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆæ ·çš„ç°è±¡ï¼š</p> <p>å½“åˆ·æ–°é¡µé¢ï¼Œæ¸²æŸ“ç»“æœè·Ÿä¹‹å‰æ— å¼‚ï¼Œä¸€åˆ‡éƒ½æ­£å¸¸æ¸²æŸ“ï¼š</p> <p><img src="/Blog/assets/img/1.614221e8.png" alt=""></p> <p>å¹¶ä¸” <code>F12</code> æ‰“å¼€æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ‰“å°çš„ <code>career</code> ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼š</p> <p><img src="/Blog/assets/img/3.60bf53e7.png" alt="3"></p> <p>æ¥ç€ï¼Œæˆ‘ä»¬ç‚¹å‡»ã€Œä¿®æ”¹å§“åã€æŒ‰é’®ï¼Œå‘ç°é¡µé¢ç›´æ¥æŠ¥é”™äº†ï¼š</p> <p><img src="/Blog/assets/img/2.d8cf3a76.png" alt="2"></p> <p>ä»æŠ¥é”™ä¿¡æ¯ä¸­å¯ä»¥çœ‹å‡º <code>React</code> åœ¨æç¤ºæˆ‘ä»¬<strong>Rendered fewer hooks than expectedï¼ˆç»„ä»¶æ¸²æŸ“çš„ Hooks æ¯”æœŸæœ›ä¸­æ›´å°‘ï¼‰</strong>ã€‚æ²¡é”™ï¼Œé¦–æ¬¡æ¸²æŸ“çš„æ—¶å€™æœ‰ä¸‰ä¸ª <code>Hook</code> è¢«è°ƒç”¨äº†ï¼Œä½†æ˜¯å½“ç‚¹å‡»æŒ‰é’®ä¹‹åè¿›å…¥æ›´æ–°æ¸²æŸ“çš„æ—¶å€™å´åªæœ‰ä¸€ä¸ª <code>Hook</code> è¢«è°ƒç”¨ï¼Œä¸Šæ–‡ä¹Ÿè¯´äº†ï¼Œ <code>React</code> è¦æ±‚åœ¨æ¯æ¬¡æ¸²æŸ“ä¸­æ‰€æœ‰çš„ <code>Hook</code> éƒ½å¿…é¡»ä»¥ç›¸åŒçš„é¡ºåºè¢«è°ƒç”¨ï¼Œçœ‹æ¥ï¼Œ <code>React</code> æç¤ºçš„æ²¡æ¯›ç—…ã€‚</p> <p>æ¥ç€ï¼Œæˆ‘ä»¬æ‰“å¼€æ§åˆ¶å°ï¼Œçœ‹çœ‹æ‰“å°çš„ <code>career</code> æœ‰æ²¡æœ‰ä»€ä¹ˆå˜åŒ–ï¼Œå¦‚ä¸‹ï¼š</p> <p><img src="/Blog/assets/img/4.c64e4caa.png" alt="4"></p> <p>å§æ§½ï¼æˆ‘æ˜æ˜ä¿®æ”¹çš„æ˜¯å§“åä¹ˆï¼Œä¸æ˜¯åº”è¯¥æ”¹ <code>name</code> å—ï¼Ÿæ€ä¹ˆæ”¹åˆ° <code>career</code> ä¸Šå»äº†ï¼Ÿï¼Ÿï¼Ÿ  ğŸ˜±ğŸ˜±ğŸ˜±</p> <p>çœ‹æ¥æˆ‘ä»¬å¿…é¡»å¾—æ‰’ä¸€æ‰’ <code>Hooks</code> çš„å®ç°æœºåˆ¶äº†ã€‚</p> <blockquote><p>æ³¨æ„ï¼šå¦‚æœä½ æƒ³å¤ç°è¿™ä¸ª Demoï¼Œè¯·å°† React ç‰ˆæœ¬è°ƒæ•´åˆ° 16.8.x</p></blockquote> <h2 id="_3-é€è¿‡ç°è±¡çœ‹æœ¬è´¨"><a href="#_3-é€è¿‡ç°è±¡çœ‹æœ¬è´¨" class="header-anchor">#</a> 3. é€è¿‡ç°è±¡çœ‹æœ¬è´¨</h2> <p>ä»ä¸Šä¸€ç« èŠ‚ä¸­çš„ <code>Demo</code> ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š**å¦‚æœä¸ä¿è¯æ¯æ¬¡æ¸²æŸ“ä¸­æ‰€æœ‰ <code>Hook</code> çš„è°ƒç”¨é¡ºåºçš„è¯ï¼Œä¼šé€ æˆ <code>Hook</code> çŠ¶æ€çš„ç´Šä¹±ã€‚**é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä»æºç çš„è§’åº¦æ¥ä¸€æ¢ç©¶ç«Ÿã€‚</p> <p>æˆ‘ä»¬ä»¥æœ€ç®€å•çš„ <code>useState</code> ä¸ºä¾‹ï¼Œåœ¨ <code>React</code> æºç ä¸­ï¼Œ <code>useState</code> æ˜¯è¿™æ ·<a href="https://github.com/facebook/react/blob/17.0.2/packages/react/src/ReactHooks.js#L80-L85" target="_blank" rel="noopener noreferrer">å®šä¹‰<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>çš„ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token parameter">initialState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dispatcher <span class="token operator">=</span> <span class="token function">resolveDispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> dispatcher<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span>initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œ <code>useState</code> çš„æºç å®šä¹‰éå¸¸ç®€å•ï¼Œå°±æ˜¯å…ˆè·å–ä¸€ä¸‹å½“å‰çš„ <code>dispatcher</code> ï¼Œç„¶åå†è°ƒç”¨ <code>dispatcher.useState</code> æ–¹æ³•å¹¶ä¸”ä¼ å…¥ <code>useState</code> çš„åˆå§‹å€¼ã€‚é‚£ä¹ˆå½“å‰çš„ <code>dispatcher</code> åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿé€šè¿‡ç ”ç©¶æºç å‘ç°ï¼Œå½“å‡½æ•°ç»„ä»¶è¿›å…¥ <code>render é˜¶æ®µ</code> çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°ç»„ä»¶å†…å­˜åœ¨ <code>Hooks</code> ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨ <a href="https://github.com/facebook/react/blob/17.0.2/packages/react-reconciler/src/ReactFiberHooks.new.js#L399-L402" target="_blank" rel="noopener noreferrer">renderWithHooks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ä¼šæ ¹æ®ä¸åŒæ¸²æŸ“æƒ…å†µå¯¹å½“å‰çš„ <code>dispatcher</code> è¿›è¡Œèµ‹å€¼ï¼Œå¦‚ä¸‹ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>ReactCurrentDispatcher<span class="token punctuation">.</span>current <span class="token operator">=</span>
  current <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> current<span class="token punctuation">.</span>memoizedState <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">?</span>
  <span class="token literal-property property">HooksDispatcherOnMount</span> <span class="token operator">:</span>
  HooksDispatcherOnUpdate<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œé¦–å…ˆä½¿ç”¨ <code>current === null || current.memoizedState === null</code> åŒºåˆ†å½“å‰ç»„ä»¶æ˜¯åœ¨ <code>mount</code> è¿˜æ˜¯ <code>update</code> ï¼Œç„¶åæŠŠä¸åŒæƒ…å†µçš„ <code>dispatcher</code> èµ‹å€¼ç»™å…¨å±€å˜é‡ <code>ReactCurrentDispatcher</code> çš„ <code>current</code> å±æ€§ï¼Œèµ‹å€¼å®Œä»¥åï¼Œåœ¨ <code>useState</code> å®šä¹‰é‡Œé€šè¿‡è°ƒç”¨ <code>resolveDispatcher</code> æ–¹æ³•å°±èƒ½è·å–åˆ°å½“å‰çš„ <code>dispatcher</code> äº†ã€‚</p> <p>ä»è¿™é‡Œæˆ‘ä»¬å°±çŸ¥é“äº†ï¼Œ <code>Hooks</code> åœ¨é¦–æ¬¡æ¸²æŸ“å’Œæ›´æ–°æ¸²æŸ“æ—¶ä½¿ç”¨çš„æ˜¯ä¸åŒçš„ <code>dispatcher</code> ï¼Œä»è€Œæ‰§è¡Œçš„æ˜¯ä¸ç”¨çš„é€»è¾‘ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹ä¸‹é¦–æ¬¡æ¸²æŸ“å’Œæ›´æ–°æ¸²æŸ“è¿™ä¸¤ç§ä¸åŒçš„ <code>dispatcher</code> é‡Œéƒ½å¹²äº†äº›ä»€ä¹ˆã€‚</p> <h3 id="_3-1-é¦–æ¬¡æ¸²æŸ“"><a href="#_3-1-é¦–æ¬¡æ¸²æŸ“" class="header-anchor">#</a> 3.1 é¦–æ¬¡æ¸²æŸ“</h3> <p>ä»ä¸Šæ–‡åˆ†æå¾—çŸ¥ï¼Œé¦–æ¬¡æ¸²æŸ“ä½¿ç”¨çš„ <code>dispatcher</code> æ˜¯ <a href="https://github.com/facebook/react/blob/17.0.2/packages/react-reconciler/src/ReactFiberHooks.old.js#L1776-L1795" target="_blank" rel="noopener noreferrer">HooksDispatcherOnMount<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œå…¶ä»£ç å¦‚ä¸‹:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token literal-property property">HooksDispatcherOnMount</span><span class="token operator">:</span> Dispatcher <span class="token operator">=</span> <span class="token punctuation">{</span>
  readContext<span class="token punctuation">,</span>
  <span class="token literal-property property">useCallback</span><span class="token operator">:</span> mountCallback<span class="token punctuation">,</span>
  <span class="token literal-property property">useContext</span><span class="token operator">:</span> readContext<span class="token punctuation">,</span>
  <span class="token literal-property property">useEffect</span><span class="token operator">:</span> mountEffect<span class="token punctuation">,</span>
  <span class="token literal-property property">useImperativeHandle</span><span class="token operator">:</span> mountImperativeHandle<span class="token punctuation">,</span>
  <span class="token literal-property property">useLayoutEffect</span><span class="token operator">:</span> mountLayoutEffect<span class="token punctuation">,</span>
  <span class="token literal-property property">useMemo</span><span class="token operator">:</span> mountMemo<span class="token punctuation">,</span>
  <span class="token literal-property property">useReducer</span><span class="token operator">:</span> mountReducer<span class="token punctuation">,</span>
  <span class="token literal-property property">useRef</span><span class="token operator">:</span> mountRef<span class="token punctuation">,</span>
  <span class="token literal-property property">useState</span><span class="token operator">:</span> mountState<span class="token punctuation">,</span>
  <span class="token literal-property property">useDebugValue</span><span class="token operator">:</span> mountDebugValue<span class="token punctuation">,</span>
  <span class="token literal-property property">useDeferredValue</span><span class="token operator">:</span> mountDeferredValue<span class="token punctuation">,</span>
  <span class="token literal-property property">useTransition</span><span class="token operator">:</span> mountTransition<span class="token punctuation">,</span>
  <span class="token literal-property property">useMutableSource</span><span class="token operator">:</span> mountMutableSource<span class="token punctuation">,</span>
  <span class="token literal-property property">useOpaqueIdentifier</span><span class="token operator">:</span> mountOpaqueIdentifier<span class="token punctuation">,</span>
  <span class="token literal-property property">unstable_isNewReconciler</span><span class="token operator">:</span> enableNewReconciler<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>è¿˜æ˜¯ä»¥ <code>useState</code> ä¸ºä¾‹ï¼Œåœ¨é¦–æ¬¡æ¸²æŸ“é˜¶æ®µè°ƒç”¨ <code>useState</code> å®é™…ä¸Šè°ƒç”¨çš„æ˜¯ <code>HooksDispatcherOnMount.useState</code> å³ <code>mountState</code> æ–¹æ³•ï¼Œæˆ‘ä»¬ç»§ç»­è¿½ <code>mountState</code> çš„å†…éƒ¨å®ç°ï¼Œå®ƒæ˜¯è¿™æ ·<a href="https://github.com/facebook/react/blob/17.0.2/packages/react-reconciler/src/ReactFiberHooks.new.js#L1126-L1149" target="_blank" rel="noopener noreferrer">å®šä¹‰<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>çš„ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">mountState</span><span class="token punctuation">(</span><span class="token parameter">initialState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å°†æ–°çš„ hook å¯¹è±¡è¿½åŠ è¿›é“¾è¡¨å°¾éƒ¨</span>
  <span class="token keyword">const</span> hook <span class="token operator">=</span> <span class="token function">mountWorkInProgressHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// initialState å¯ä»¥æ˜¯ä¸€ä¸ªå›è°ƒï¼Œè‹¥æ˜¯å›è°ƒï¼Œåˆ™å–å›è°ƒæ‰§è¡Œåçš„å€¼</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> initialState <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    initialState <span class="token operator">=</span> <span class="token function">initialState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å°† initialState ä½œä¸ºä¸€ä¸ªâ€œè®°å¿†å€¼â€å­˜ä¸‹æ¥</span>
  hook<span class="token punctuation">.</span>memoizedState <span class="token operator">=</span> hook<span class="token punctuation">.</span>baseState <span class="token operator">=</span> initialState<span class="token punctuation">;</span>
  <span class="token comment">// åˆ›å»ºå½“å‰ hook å¯¹è±¡çš„æ›´æ–°é˜Ÿåˆ—ï¼Œè¿™ä¸€æ­¥ä¸»è¦æ˜¯ä¸ºäº†èƒ½å¤Ÿä¾åºä¿ç•™ dispatch</span>
  <span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token punctuation">(</span>hook<span class="token punctuation">.</span>queue <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">pending</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token literal-property property">dispatch</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lastRenderedReducer</span><span class="token operator">:</span> basicStateReducer<span class="token punctuation">,</span>
    <span class="token literal-property property">lastRenderedState</span><span class="token operator">:</span> <span class="token punctuation">(</span>initialState<span class="token operator">:</span> any<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token punctuation">(</span>queue<span class="token punctuation">.</span>dispatch <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">dispatchAction</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>
    <span class="token keyword">null</span><span class="token punctuation">,</span>
    currentlyRenderingFiber<span class="token punctuation">,</span>
    queue<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token operator">:</span> any<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// è¿”å›ç›®æ ‡æ•°ç»„ï¼Œdispatch å…¶å®å°±æ˜¯å¸¸å¸¸è§åˆ°çš„ setXXX è¿™ä¸ªå‡½æ•°</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>hook<span class="token punctuation">.</span>memoizedState<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>ä»è¿™æ®µæºç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œ<strong>mounState çš„ä¸»è¦å·¥ä½œæ˜¯åˆå§‹åŒ– Hooks</strong>ã€‚åœ¨æ•´æ®µæºç ä¸­ï¼Œæœ€éœ€è¦å…³æ³¨çš„æ˜¯ <code>mountWorkInProgressHook</code> æ–¹æ³•ï¼Œå®ƒä¸ºæˆ‘ä»¬é“å‡ºäº† <code>Hooks</code> èƒŒåçš„æ•°æ®ç»“æ„ç»„ç»‡å½¢å¼ã€‚ä»¥ä¸‹æ˜¯ <code>mountWorkInProgressHook</code> æ–¹æ³•çš„<a href="https://github.com/facebook/react/blob/17.0.2/packages/react-reconciler/src/ReactFiberHooks.new.js#L544-L563" target="_blank" rel="noopener noreferrer">å®šä¹‰<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">mountWorkInProgressHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// æ³¨æ„ï¼Œå•ä¸ª hook æ˜¯ä»¥å¯¹è±¡çš„å½¢å¼å­˜åœ¨çš„</span>
  <span class="token keyword">const</span> hook <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">memoizedState</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token literal-property property">baseState</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token literal-property property">baseQueue</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token literal-property property">queue</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token literal-property property">next</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>workInProgressHook <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è‹¥æ­£åœ¨å¤„ç†çš„ hook é“¾è¡¨ä¸ºç©ºï¼Œåˆ™å°†ä¸Šé¢å®šä¹‰å¥½çš„ hook ä½œä¸ºé“¾è¡¨çš„å¤´èŠ‚ç‚¹</span>
    currentlyRenderingFiber<span class="token punctuation">.</span>memoizedState <span class="token operator">=</span> workInProgressHook <span class="token operator">=</span> hook<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// è‹¥é“¾è¡¨ä¸ä¸ºç©ºï¼Œåˆ™å°† hook è¿½åŠ åˆ°é“¾è¡¨å°¾éƒ¨</span>
    workInProgressHook <span class="token operator">=</span> workInProgressHook<span class="token punctuation">.</span>next <span class="token operator">=</span> hook<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> workInProgressHook<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>åˆ°è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œ<strong>hook ç›¸å…³çš„æ‰€æœ‰ä¿¡æ¯æ”¶æ•›åœ¨ä¸€ä¸ª hook å¯¹è±¡é‡Œï¼Œè€Œ hook å¯¹è±¡ä¹‹é—´ä»¥å•å‘é“¾è¡¨çš„å½¢å¼ç›¸äº’ä¸²è”</strong>ã€‚</p> <p>åˆ°è¿™é‡Œï¼ŒçœŸç›¸å·²ç»å¼€å§‹é€æ¸æµ®å‡ºæ°´é¢äº†ï¼šç»„ä»¶ä¸­çš„æ‰€æœ‰ <code>Hooks</code> ä¹‹é—´éƒ½æ˜¯ä»¥å•å‘é“¾è¡¨çš„å½¢å¼ä¸²è”ï¼Œç¯ç¯ç›¸æ‰£çš„ã€‚</p> <p>æˆ‘ä»¬å¯ä»¥å¤§èƒ†çŒœæƒ³ä¸€ä¸‹ï¼šå‡å¦‚é“¾æ¥ä¸­é—´æœ‰ä¸€ç¯ä¸¢å¤±äº†ï¼Œé‚£ä¹ˆè¿™æ¡é“¾è¡¨çš„é¡ºåºå°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä»è€Œæœ‰å¯èƒ½å¯¼è‡´è¿˜å­˜åœ¨åœ¨é“¾è¡¨ä¹‹ä¸­çš„ <code>Hook</code> çŠ¶æ€ä¸ä¹‹å‰æ— æ³•å¯¹åº”çš„æƒ…å†µï¼Œä»è€Œå¯¼è‡´ <code>hook</code> çŠ¶æ€ç´Šä¹±ã€‚</p> <p>é‚£ä¹ˆçœŸç›¸åˆ°åº•æ˜¯ä¸æ˜¯å¦‚æˆ‘ä»¬çŒœæƒ³çš„è¿™èˆ¬å‘¢ï¼Ÿåˆ«æ€¥ï¼Œæˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï¼Œçœ‹å®Œäº†é¦–æ¬¡æ¸²æŸ“çš„æƒ…å†µï¼Œæˆ‘ä»¬ç»§ç»­çœ‹æ›´æ–°æ¸²æŸ“æ—¶éƒ½å¹²äº†äº›ä»€ä¹ˆã€‚</p> <h3 id="_3-2-æ›´æ–°æ¸²æŸ“"><a href="#_3-2-æ›´æ–°æ¸²æŸ“" class="header-anchor">#</a> 3.2 æ›´æ–°æ¸²æŸ“</h3> <p>æ›´æ–°æ¸²æŸ“ä½¿ç”¨çš„ <code>dispatcher</code> æ˜¯ <a href="https://github1s.com/facebook/react/blob/17.0.2/packages/react-reconciler/src/ReactFiberHooks.old.js#L1797-L1816" target="_blank" rel="noopener noreferrer">HooksDispatcherOnUpdate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token literal-property property">HooksDispatcherOnUpdate</span><span class="token operator">:</span> Dispatcher <span class="token operator">=</span> <span class="token punctuation">{</span>
  readContext<span class="token punctuation">,</span>
  <span class="token literal-property property">useCallback</span><span class="token operator">:</span> updateCallback<span class="token punctuation">,</span>
  <span class="token literal-property property">useContext</span><span class="token operator">:</span> readContext<span class="token punctuation">,</span>
  <span class="token literal-property property">useEffect</span><span class="token operator">:</span> updateEffect<span class="token punctuation">,</span>
  <span class="token literal-property property">useImperativeHandle</span><span class="token operator">:</span> updateImperativeHandle<span class="token punctuation">,</span>
  <span class="token literal-property property">useLayoutEffect</span><span class="token operator">:</span> updateLayoutEffect<span class="token punctuation">,</span>
  <span class="token literal-property property">useMemo</span><span class="token operator">:</span> updateMemo<span class="token punctuation">,</span>
  <span class="token literal-property property">useReducer</span><span class="token operator">:</span> updateReducer<span class="token punctuation">,</span>
  <span class="token literal-property property">useRef</span><span class="token operator">:</span> updateRef<span class="token punctuation">,</span>
  <span class="token literal-property property">useState</span><span class="token operator">:</span> updateState<span class="token punctuation">,</span>
  <span class="token literal-property property">useDebugValue</span><span class="token operator">:</span> updateDebugValue<span class="token punctuation">,</span>
  <span class="token literal-property property">useDeferredValue</span><span class="token operator">:</span> updateDeferredValue<span class="token punctuation">,</span>
  <span class="token literal-property property">useTransition</span><span class="token operator">:</span> updateTransition<span class="token punctuation">,</span>
  <span class="token literal-property property">useMutableSource</span><span class="token operator">:</span> updateMutableSource<span class="token punctuation">,</span>
  <span class="token literal-property property">useOpaqueIdentifier</span><span class="token operator">:</span> updateOpaqueIdentifier<span class="token punctuation">,</span>
  <span class="token literal-property property">unstable_isNewReconciler</span><span class="token operator">:</span> enableNewReconciler<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>åœ¨æ›´æ–°æ¸²æŸ“é˜¶æ®µè°ƒç”¨ <code>useState</code> å®é™…ä¸Šè°ƒç”¨çš„æ˜¯ <code>HooksDispatcherOnUpdate.useState</code> å³ <code>updateState</code> æ–¹æ³•ï¼Œå®ƒæ˜¯è¿™æ ·<a href="https://github.com/facebook/react/blob/17.0.2/packages/react-reconciler/src/ReactFiberHooks.old.js#L1138-L1142" target="_blank" rel="noopener noreferrer">å®šä¹‰<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>çš„ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">updateState</span><span class="token punctuation">(</span><span class="token parameter">initialState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">updateReducer</span><span class="token punctuation">(</span>basicStateReducer<span class="token punctuation">,</span> initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œ <code>updateState</code> æ–¹æ³•æœ€ç»ˆä¼šè½åˆ° <code>updateReducer</code> è¿™ä¸ªæ–¹æ³•ä¸­ã€‚</p> <blockquote><p>ç”±äºåœ¨æºç ä¸­ï¼ŒuseState å’Œ useReducer å¤ç”¨äº†ä¸€å¥—æ›´æ–°æœºåˆ¶ï¼Œæ‰€ä»¥ updateReducer æ–¹æ³•çš„ä»£ç é‡å¾ˆå¤§ï¼Œæ­¤å¤„ä¸å†é€è¡Œè§£æï¼Œæœ‰å…´è¶£çš„è¯å¯ä»¥çœ‹æºç å®šä¹‰ï¼Œ<a href="https://github.com/facebook/react/blob/17.0.2/packages/react-reconciler/src/ReactFiberHooks.old.js#L651-L783" target="_blank" rel="noopener noreferrer">åœ¨è¿™é‡Œ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p></blockquote> <p>å…¶å® <code>updateState</code> åšçš„çš„äº‹æƒ…å¾ˆå®¹æ˜“ç†è§£ï¼Œé‚£å°±æ˜¯ï¼š<strong>æŒ‰é¡ºåºå»éå†ä¹‹å‰æ„å»ºå¥½çš„é“¾è¡¨ï¼Œå–å‡ºå¯¹åº”çš„æ•°æ®ä¿¡æ¯è¿›è¡Œæ¸²æŸ“</strong>ã€‚</p> <h3 id="_3-3-å°ç»“"><a href="#_3-3-å°ç»“" class="header-anchor">#</a> 3.3 å°ç»“</h3> <p>ç°åœ¨ï¼Œæˆ‘ä»¬æŠŠ <code>mountState</code> å’Œ <code>updateStat</code> e åšçš„äº‹æƒ…æ”¾åœ¨ä¸€èµ·æ¥çœ‹ï¼Œä¸éš¾å¾—å‡ºï¼š</p> <p><code>mountState</code> ï¼ˆé¦–æ¬¡æ¸²æŸ“ï¼‰æ„å»ºé“¾è¡¨å¹¶æ¸²æŸ“ï¼›</p> <p><code>updateState</code> ï¼ˆæ›´æ–°æ¸²æŸ“ï¼‰ä¾æ¬¡éå†é“¾è¡¨å¹¶æ¸²æŸ“ã€‚</p> <p>çœ‹æ¥ï¼ŒçœŸç›¸åªæœ‰ä¸€ä¸ªï¼š<strong>hooks çš„æ¸²æŸ“æ˜¯é€šè¿‡ã€Œä¾æ¬¡éå†ã€æ¥å®šä½æ¯ä¸ª hooks å†…å®¹çš„ã€‚å¦‚æœå‰åä¸¤æ¬¡è¯»åˆ°çš„é“¾è¡¨åœ¨é¡ºåºä¸Šå‡ºç°å·®å¼‚ï¼Œé‚£ä¹ˆæ¸²æŸ“çš„ç»“æœè‡ªç„¶æ˜¯ä¸å¯æ§çš„</strong>ã€‚</p> <h2 id="_4-å›çœ‹demo"><a href="#_4-å›çœ‹demo" class="header-anchor">#</a> 4. å›çœ‹Demo</h2> <p>äº†è§£äº† <code>Hooks</code> çš„å·¥ä½œæœºåˆ¶åï¼Œæˆ‘ä»¬å›çœ‹ä¸Šæ–‡å†™çš„ <code>Demo</code> ï¼Œä»å·¥ä½œæœºåˆ¶è§’åº¦åˆ†æä¸€æ³¢ã€‚</p> <p>åœ¨ <code>Demo</code> ä¸­æˆ‘ä»¬å®šä¹‰äº†ä¸‰ä¸ªçŠ¶æ€ï¼Œåˆ†åˆ«æ˜¯ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;éš¾å‡‰çƒ­è¡€&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>career<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;å‰ç«¯å¼€å‘&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>åœ¨é¦–æ¬¡æ¸²æŸ“ä¸­ï¼Œæ„å»ºå¾—åˆ°çš„ <code>Hooks</code> é“¾è¡¨æ˜¯è¿™æ ·çš„ï¼š</p> <p><img src="/Blog/assets/img/5.cc5baf6a.png" alt="5"></p> <p>å½“ç‚¹å‡»ã€Œä¿®æ”¹å§“åã€æŒ‰é’®è¿›è¡Œæ›´æ–°æ¸²æŸ“æ—¶ï¼Œæ­¤æ—¶ <code>name</code> å’Œ <code>age</code> çš„ <code>useState</code> ä¸ä¼šè¢«è°ƒç”¨ï¼Œåªä¼šè°ƒç”¨ <code>career</code> çš„ <code>useState</code> ã€‚æ­¤æ—¶å¯¹äº <code>React</code> æ¥è¯´ï¼Œæˆ‘ä¸ä¼šçœ‹ä½ å‘½åçš„å˜é‡åæ˜¯ <code>career</code> è¿˜æ˜¯åˆ«çš„ä»€ä¹ˆï¼Œæˆ‘åªè®¤ä½ è¿™æ˜¯ç¬¬ä¸€æ¬¡ <code>useState</code> è°ƒç”¨ï¼Œäºæ˜¯å°±ä¼šè®¤ä¸ºï¼š<strong>å–”ï¼ŒåŸæ¥ä½ æƒ³è¦çš„æ˜¯ç¬¬ä¸€ä¸ªä½ç½®çš„ hook å•Š</strong>ã€‚</p> <p>è€Œåœ¨æ„å»ºé“¾è¡¨çš„æ—¶å€™ï¼Œé“¾è¡¨ç¬¬ä¸€ä¸ªä½ç½®æ˜¯ <code>name</code> ï¼Œå¹¶ä¸”å¯¹åº”çš„å€¼è¢«æ”¹ä¸ºäº†ï¼šçƒ­è¡€éš¾å‡‰ã€‚</p> <p>æ‰€ä»¥å°±å‡ºç°äº† <code>Demo</code> ä¸­çš„é‚£ä¸€å¹•ï¼šä»å¼€å‘è€…è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä¿®æ”¹çš„æ˜¯ <code>name</code> çŠ¶æ€ï¼Œä½ å´ç»™æˆ‘æ”¹çš„æ˜¯ <code>career</code> çŠ¶æ€ï¼›è€Œä» <code>React</code> è§’åº¦æ¥çœ‹ï¼Œä½ è¦çš„ä»…ä»…æ˜¯ç¬¬ä¸€ä¸ª <code>Hook</code> è€Œå·²ã€‚</p> <h2 id="_5-æ€»ç»“"><a href="#_5-æ€»ç»“" class="header-anchor">#</a> 5. æ€»ç»“</h2> <p>å‡½æ•°ç»„ä»¶ä¸­çš„ <code>Hooks</code> æ˜¯ä»¥å•å‘é“¾è¡¨å½¢å¼ç›¸äº’ä¸²è”çš„ï¼Œåœ¨é¦–æ¬¡æ¸²æŸ“æ—¶ <code>mountState</code> æ„å»ºé“¾è¡¨å¹¶æ¸²æŸ“ï¼Œåœ¨æ›´æ–°æ¸²æŸ“æ—¶ <code>updateState</code> ä¼šä¾æ¬¡éå†é“¾è¡¨ã€è¯»å–æ•°æ®å¹¶æ¸²æŸ“ã€‚æ³¨æ„è¿™ä¸ªè¿‡ç¨‹å°±åƒä»æ•°ç»„ä¸­ä¾æ¬¡å–å€¼ä¸€æ ·ï¼Œæ˜¯å®Œå…¨æŒ‰ç…§é¡ºåºï¼ˆæˆ–è€…è¯´ç´¢å¼•ï¼‰æ¥çš„ã€‚</p> <p>æ‰€ä»¥ï¼Œåœ¨å¼€å‘ä¸­ï¼Œå¿…é¡»ç¡®ä¿æ‰€æœ‰ <code>Hook</code> åœ¨æ¯æ¬¡æ¸²æŸ“ä¸­éƒ½æŒ‰ç…§åŒæ ·çš„é¡ºåºè¢«è°ƒç”¨ï¼Œä¿è¯é“¾è¡¨çš„å®Œæ•´æ€§ï¼</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/NLRX-WJC/Blog/edit/master/docs/react/hook/Hookså·¥ä½œæœºåˆ¶.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">1/23/2022, 10:00:55 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/Blog/react/hook/ä¸ºä»€ä¹ˆéœ€è¦Hooks.html" class="prev">
        ä¸ºä»€ä¹ˆéœ€è¦Hooks
      </a></span> <span class="next"><a href="/Blog/react/lifecycle/æ—§ç‰ˆ.html">
        æ—§ç‰ˆ
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/Blog/assets/js/app.b4826e9a.js" defer></script><script src="/Blog/assets/js/2.f12389d1.js" defer></script><script src="/Blog/assets/js/1.9a8c901b.js" defer></script><script src="/Blog/assets/js/23.10dcfcdc.js" defer></script><script src="/Blog/assets/js/42.d35d384d.js" defer></script>
  </body>
</html>
